import{g as c,O as B,h as C,w as E,b as P,c as i,a as l,t as b,u as o,l as r,B as g,G as $,W as N,k as V,a3 as j,U as S,o as n,F as T,j as F}from"./main-DL69bNQp.js";import{E as L}from"./card-Dfi-AynD.js";import{p as D,_ as G,a as I}from"./Loading-D04WBFpf.js";import{i as M}from"./isString-BYZQ6BTf.js";import"./event-BB_Ol6Sd.js";const O={class:"py-6 px-10"},R={class:"invicta-form w-2/3"},U={class:"flex items-center justify-between mb-4"},W={key:0,class:"flex items-center justify-center h-full"},q={key:1,class:"w-full"},z={class:"pb-6"},A={key:0,class:"text-base font-bold pb-2"},H={class:"px-5"},ee={__name:"PermissionEdit",setup(J){const u=V(),d=c("Permissions"),t=c(!1);B({permissions:[]});const _=c([]),m=c([]);C(()=>{f(!0)}),E(()=>u.params.id,()=>{f()});function f(e=!1){t.value=!0;let s=e?{params:{tree:!0}}:{};Invicta.fetch.get(`api${u.path}`,s).then(a=>{e&&a.tree&&(_.value=a.tree),d.value=`${a.title} Permissions`,Invicta.pageTitle(d.value),m.value=a.permissions,t.value=!1})}const h=P(()=>_.value.map(e=>({checked:!0,label:e.label,children:e.permissions.map(s=>v(s))})));function v(e){return{label:e.label,value:e.permission,checked:m.value.length?m.value.includes(e.permission):!1,children:e.children?e.children.map(s=>v(s)):[]}}function k(){t.value=!0;let e=D(j(h.value),M);Invicta.fetch.post(`api${u.path}`,{permissions:e}).then(s=>{Invicta.message(s.message),t.value=!1})}return(e,s)=>{const a=S,y=G,x=I,w=L;return n(),i("div",O,[l("div",R,[l("div",U,[l("div",null,[l("h1",null,b(o(d)),1)]),r(a,{type:"primary",onClick:k,disabled:o(t),loading:o(t)},{default:g(()=>s[0]||(s[0]=[T("Save",-1)])),_:1,__:[0]},8,["disabled","loading"])]),o(t)?(n(),i("div",W,[r(y)])):(n(),i("div",q,[(n(!0),i($,null,N(o(h),p=>(n(),i("div",z,[p.label?(n(),i("header",A,b(p.label),1)):F("",!0),r(w,null,{default:g(()=>[l("div",H,[r(x,{"initial-items":p.children,disabled:!1,depth:1},null,8,["initial-items"])])]),_:2},1024)]))),256))]))])])}}};export{ee as default};

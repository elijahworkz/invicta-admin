import{d as N,_ as O,a as T,b as V}from"./dropdown-menu-CgCmB9xa.js";import{_ as z}from"./AssetForm-CuIPlHw0.js";import{_ as D}from"./FieldBase-DWvTZj_s.js";import{b as E,O as P,o,c as r,l as y,B as x,u as e,a as g,C as j,eP as L,t as m,G as h,F as Q,eQ as R,j as l,d,P as U,Q as G,R as M}from"./main-Cb0PFlp0.js";import{u as q}from"./field-B2jNcHaR.js";import{u as H}from"./FormBase-DaTWT1Gg.js";import{E as J}from"./index-B8oPdYJ_.js";import"./Loading-CcbqUtbb.js";import"./event-BB_Ol6Sd.js";import"./vnode-Jytc64K1.js";import"./isString-DdWyWSbS.js";import"./card-B08ajyLB.js";import"./validator-BkWg9Q-T.js";const K={key:0,class:"asset-wrap"},W=["src"],X={class:"asset-details mr-auto"},Y={key:2,class:"asset-wrap"},fe={__name:"assetField",props:{formId:String,data:Object,path:String},setup(f){const _=f,i=q(_),t=i.value(),v=E(()=>t.value.hasOwnProperty("type")?t.value.type=="image":!0),b=H(_.formId).remoteData.get("assetActions"),s=P({state:!1,context:"library"}),k=n=>{t.value=n,s.state=!1},w=()=>{i.disabled||(s.context="edit",s.state=!0)},C=({action:n,item:a})=>{console.log("action call",n,a),J.confirm("Are you sure you want to run this action?",n.name,{confirmButtonText:n.action_button,cancelButtonText:"Cancel",confirmButtonClass:n.dangerous?"el-button--danger":"el-button--primary"}).then(()=>{let u={class:n.class,selected:[a.id]};Invicta.fetch.post("api/resource/assets/actions",u).then(p=>{Invicta.message(p.message),t.value=p.asset})}).catch(()=>console.log("cancel"))},B=()=>{s.context="library",s.state=!0};return(n,a)=>{const u=M,p=N,F=O,$=D,A=T,S=z,I=V;return o(),r(h,null,[y($,{"form-id":f.formId,"field-props":_},{default:x(()=>{var c;return[e(t)?(o(),r("div",K,[e(v)?(o(),r("div",{key:0,class:"asset",onClick:w},[g("img",{src:e(t).src},null,8,W)])):(o(),r("div",{key:1,class:j(["asset opacity-50",e(t).type])},[y(u,{icon:e(L),width:24},null,8,["icon"])],2)),g("div",X,[g("strong",null,m(e(t).name),1),e(v)?(o(),r(h,{key:0},[Q(m(e(t).width)+"x"+m(e(t).height)+" | "+m(e(t).size?e(R)(e(t).size):"n/a")+" "+m(e(t).alt?e(t).alt:"No Alt!"),1)],64)):l("",!0)]),e(b).length?(o(),d(p,{key:2,actions:e(b),item:e(t),onSelected:C,class:"mr-3"},null,8,["actions","item"])):l("",!0),e(i).disabled?l("",!0):(o(),r("span",{key:3,class:"mr-3 action-icon",onClick:a[0]||(a[0]=ee=>t.value=null)},[y(u,{icon:e(U),width:18},null,8,["icon"])]))])):e(i).disabled?e(i).disabled?(o(),r("div",Y,"No image")):l("",!0):(o(),d(F,{key:1,type:"browse",onUploadComplete:k,onOpenLibrary:B,single:!0,folder:((c=f.data.props)==null?void 0:c.folder)||null},null,8,["folder"]))]}),_:1},8,["form-id","field-props"]),e(s).state?(o(),d(I,{key:0,onClose:a[3]||(a[3]=c=>e(s).state=!1),style:G({width:e(s).context=="library"?"80%":""})},{default:x(()=>[e(s).context=="library"?(o(),d(A,{key:0,onSelected:k,onCancel:a[1]||(a[1]=c=>e(s).state=!1)})):l("",!0),e(s).context=="edit"?(o(),d(S,{key:1,asset:e(t),onClose:a[2]||(a[2]=c=>e(s).state=!1)},null,8,["asset"])):l("",!0)]),_:1},8,["style"])):l("",!0)],64)}}};export{fe as default};

import{_ as be}from"./FieldBase-B__KXuFD.js";import{m as he,aS as H,eW as g,bZ as Q,eX as Ve,au as ye,aE as xe,av as Z,s as re,ax as J,bU as we,bV as Ce,az as _e,x as ge,aH as Ie,g as N,b as i,bt as B,ae as Y,dV as P,ab as ee,w as Se,o as u,c as p,G as M,W as Ee,C as b,u as l,l as A,B as j,i as ae,d as y,r as I,H as le,j as F,E as oe,Q as k,t as Te,K as De,a_ as S,bP as te,L as He,aP as Ne,ag as Be}from"./main-Gom_X7XC.js";import{u as Pe}from"./field-BIfiLAjy.js";import{m as se}from"./vnode-Cs930f0e.js";import{C as O,U as E}from"./event-BB_Ol6Sd.js";import"./dropdown-menu-BVI0Wl79.js";import"./Loading-C6aktGFb.js";import"./FormBase-BhlFrBgY.js";import"./isString-DeC8ACer.js";import"./card-DTfKIn5u.js";const Me=he({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:H([Array,Object]),default:()=>se(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:H([Array,Object]),default:()=>[g,g,g]},voidIcon:{type:Q,default:()=>Ve},disabledVoidIcon:{type:Q,default:()=>g},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:H(Array),default:()=>se(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:ye,clearable:Boolean,...xe(["ariaLabel"])}),Fe={[O]:d=>Z(d),[E]:d=>Z(d)},ke=re({name:"ElRate"}),Ae=re({...ke,props:Me,emits:Fe,setup(d,{expose:x,emit:m}){const e=d;function w(a,o){const t=n=>Y(n),c=Object.keys(o).map(n=>+n).filter(n=>{const _=o[n];return(t(_)?_.excluded:!1)?a<n:a<=n}).sort((n,_)=>n-_),V=o[c[0]];return t(V)&&V.value||V}const h=J(we,void 0),C=J(Ce,void 0),T=_e(),s=ge("rate"),{inputId:ne,isLabeledByFormItem:z}=Ie(e,{formItemContext:C}),r=N(e.modelValue),D=N(-1),v=N(!0),ie=i(()=>[s.b(),s.m(T.value)]),f=i(()=>e.disabled||(h==null?void 0:h.disabled)),ue=i(()=>s.cssVarBlock({"void-color":e.voidColor,"disabled-void-color":e.disabledVoidColor,"fill-color":K.value})),L=i(()=>{let a="";return e.showScore?a=e.scoreTemplate.replace(/\{\s*value\s*\}/,f.value?`${e.modelValue}`:`${r.value}`):e.showText&&(a=e.texts[Math.ceil(r.value)-1]),a}),$=i(()=>e.modelValue*100-Math.floor(e.modelValue)*100),de=i(()=>B(e.colors)?{[e.lowThreshold]:e.colors[0],[e.highThreshold]:{value:e.colors[1],excluded:!0},[e.max]:e.colors[2]}:e.colors),K=i(()=>{const a=w(r.value,de.value);return Y(a)?"":a}),ce=i(()=>{let a="";return f.value?a=`${$.value}%`:e.allowHalf&&(a="50%"),{color:K.value,width:a}}),W=i(()=>{let a=B(e.icons)?[...e.icons]:{...e.icons};return a=P(a),B(a)?{[e.lowThreshold]:a[0],[e.highThreshold]:{value:a[1],excluded:!0},[e.max]:a[2]}:a}),fe=i(()=>w(e.modelValue,W.value)),R=i(()=>f.value?ee(e.disabledVoidIcon)?e.disabledVoidIcon:P(e.disabledVoidIcon):ee(e.voidIcon)?e.voidIcon:P(e.voidIcon)),me=i(()=>w(r.value,W.value));function U(a){const o=f.value&&$.value>0&&a-1<e.modelValue&&a>e.modelValue,t=e.allowHalf&&v.value&&a-.5<=r.value&&a>r.value;return o||t}function G(a){e.clearable&&a===e.modelValue&&(a=0),m(E,a),e.modelValue!==a&&m(O,a)}function ve(a){f.value||(e.allowHalf&&v.value?G(r.value):G(a))}function pe(a){if(f.value)return;let o=r.value;const t=a.code;return t===S.up||t===S.right?(e.allowHalf?o+=.5:o+=1,a.stopPropagation(),a.preventDefault()):(t===S.left||t===S.down)&&(e.allowHalf?o-=.5:o-=1,a.stopPropagation(),a.preventDefault()),o=o<0?0:o,o=o>e.max?e.max:o,m(E,o),m(O,o),o}function X(a,o){if(!f.value){if(e.allowHalf&&o){let t=o.target;te(t,s.e("item"))&&(t=t.querySelector(`.${s.e("icon")}`)),(t.clientWidth===0||te(t,s.e("decimal")))&&(t=t.parentNode),v.value=o.offsetX*2<=t.clientWidth,r.value=v.value?a-.5:a}else r.value=a;D.value=a}}function q(){f.value||(e.allowHalf&&(v.value=e.modelValue!==Math.floor(e.modelValue)),r.value=e.modelValue,D.value=-1)}return Se(()=>e.modelValue,a=>{r.value=a,v.value=e.modelValue!==Math.floor(e.modelValue)}),e.modelValue||m(E,0),x({setCurrentValue:X,resetCurrentValue:q}),(a,o)=>{var t;return u(),p("div",{id:l(ne),class:b([l(ie),l(s).is("disabled",l(f))]),role:"slider","aria-label":l(z)?void 0:a.ariaLabel||"rating","aria-labelledby":l(z)?(t=l(C))==null?void 0:t.labelId:void 0,"aria-valuenow":r.value,"aria-valuetext":l(L)||void 0,"aria-valuemin":"0","aria-valuemax":a.max,tabindex:"0",style:k(l(ue)),onKeydown:pe},[(u(!0),p(M,null,Ee(a.max,(c,V)=>(u(),p("span",{key:V,class:b(l(s).e("item")),onMousemove:n=>X(c,n),onMouseleave:q,onClick:n=>ve(c)},[A(l(oe),{class:b([l(s).e("icon"),{hover:D.value===c},l(s).is("active",c<=r.value)])},{default:j(()=>[U(c)?F("v-if",!0):(u(),p(M,{key:0},[ae((u(),y(I(l(me)),null,null,512)),[[le,c<=r.value]]),ae((u(),y(I(l(R)),null,null,512)),[[le,!(c<=r.value)]])],64)),U(c)?(u(),p(M,{key:1},[(u(),y(I(l(R)),{class:b([l(s).em("decimal","box")])},null,8,["class"])),A(l(oe),{style:k(l(ce)),class:b([l(s).e("icon"),l(s).e("decimal")])},{default:j(()=>[(u(),y(I(l(fe))))]),_:1},8,["style","class"])],64)):F("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),a.showText||a.showScore?(u(),p("span",{key:0,class:b(l(s).e("text")),style:k({color:a.textColor})},Te(l(L)),7)):F("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var je=De(Ae,[["__file","rate.vue"]]);const Oe=He(je),Ze={__name:"rateField",props:{formId:String,data:Object,path:String},setup(d){const x=d,m=Pe(x),e=m.value();return(w,h)=>{const C=Oe,T=be;return u(),y(T,{"form-id":d.formId,"field-props":x},{default:j(()=>[A(C,Ne({modelValue:l(e),"onUpdate:modelValue":h[0]||(h[0]=s=>Be(e)?e.value=s:null)},d.data.props,{disabled:l(m).disabled,colors:d.data.colors}),null,16,["modelValue","disabled","colors"])]),_:1},8,["form-id","field-props"])}}};export{Ze as default};
